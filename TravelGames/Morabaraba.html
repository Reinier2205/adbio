<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Styled Node Graph</title>
    
    <!-- Font Imports for the theme -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&family=Playfair+Display:wght=700&display=swap" rel="stylesheet">
    
    <style>
        /* CSS Variables from the game styling */
        :root{
            --felt-green:#0a4821;
            --dark-wood:#2a1a1f;
            --gold:#ffd700;
            --gold-light:#fff8e1; /* Using this for general light text/lines */
            --light-gold:#fff8e1; 
            --ivory:#faf8f0;
            --piece-size: 56px; /* Matching NODE_RADIUS * 2 */
        }
        *{box-sizing:border-box;margin:0;padding:0}
        
        /* Body Styling - Dark wood background */
        body{
            font-family:'Roboto',sans-serif;
            background-color: var(--dark-wood);
            background-image: radial-gradient(circle, #4d322e 0%, var(--dark-wood) 70%);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 1rem;
            color: var(--light-gold);
        }
        
        /* Table Styling - Felt green background with gold border */
        .table {
            background: var(--felt-green);
            border: 10px solid #4a2c2a;
            box-shadow: 0 0 0 5px var(--gold), inset 0 0 25px rgba(0,0,0,0.5);
            border-radius: 15px;
            padding: 2rem;
            width: 100%;
            max-width: 700px; /* Increased max-width for the wider graph */
            text-align: center;
            position: relative;
        }

        /* Title Styling */
        .title{
            font-family:'Playfair Display', serif;
            color: var(--gold);
            font-size: 2.5rem;
            text-shadow: 2px 2px 5px rgba(0,0,0,0.7);
            margin-bottom: 1.5rem;
            text-align: center;
        }

        /* Canvas styling adjusted to fit the dark theme inside the felt area */
        #graphCanvas {
            /* Using ivory for a warm white canvas contrast, with subtle shadow */
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.4), inset 0 0 10px rgba(0,0,0,0.2);
            background-color: var(--ivory); 
            border-radius: 0.75rem; 
            max-width: 100%;
            height: auto; 
            display: block;
            margin: 0 auto;
        }

        /* --- Player Indicators --- */
        .player-info {
            display: flex;
            justify-content: space-around;
            padding: 10px 0;
            margin: 1rem 0; /* Reduced margin */
            gap: 1rem;
            flex-wrap: wrap; 
        }
        .player-card {
            background: linear-gradient(145deg, #3e1e24, #2a1a1f);
            padding: 0.4rem; /* Significantly reduced padding */
            border-radius: 10px;
            /* Calculate width to fit exactly half the container minus the gap */
            width: calc(50% - 0.5rem); 
            min-width: unset; /* Removed minimum width constraint */
            border: 3px solid #1a1a1a;
            box-shadow: inset 0 2px 5px rgba(0,0,0,0.5), 0 5px 15px rgba(0,0,0,0.4);
            color: var(--light-gold);
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .player-card.active {
            border-color: var(--gold);
            transform: scale(1.05);
            box-shadow: inset 0 2px 5px rgba(0,0,0,0.5), 0 5px 15px rgba(0,0,0,0.4), 0 0 20px var(--gold);
        }
        .piece-display {
            width: 18px; /* Reduced size */
            height: 18px; /* Reduced size */
            border-radius: 50%;
            margin-bottom: 0.2rem; /* Reduced margin */
            /* Match piece styling */
            box-shadow: 
                inset 6px 6px 12px rgba(0,0,0,0.3),
                inset -3px -3px 8px rgba(255,255,255,0.06),
                0 6px 12px rgba(0,0,0,0.4);
        }
        .piece-display.yellow { 
            background: radial-gradient(120% 120% at 30% 20%, #dcdcdc, #B5A599 40%, #8c7f76 100%);
            border: 2px solid #8c7f76;
        }
        .piece-display.red { 
            background: radial-gradient(120% 120% at 30% 20%, #ffaaaa, #E57373 40%, #b34a4a 100%);
            border: 2px solid #b34a4a;
        }
        .player-header {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 0.3rem; 
            margin-bottom: 0.2rem; 
        }
        .player-header h2 {
            font-size: 0.9rem; /* Significantly reduced font size */
            color: var(--light-gold);
            font-weight: 700;
        }

        /* Removed unused editing and player-name styles */

        /* --- Game Controls (New Section) --- */
        .game-controls {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }
        .control-button {
            padding: 0.75rem 1.5rem;
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--dark-wood);
            background-color: var(--gold);
            border: none;
            border-radius: 8px;
            cursor: pointer;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.5);
            transition: all 0.2s ease;
            text-transform: uppercase;
        }
        .control-button:hover {
            background-color: var(--gold-light);
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.7);
            transform: translateY(-2px);
        }
        .control-button:active {
            transform: translateY(0);
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.5);
        }

        .game-status {
            background: linear-gradient(90deg, #1a1a1a, #3e1e24, #1a1a1a);
            color: var(--gold);
            font-family: 'Playfair Display', serif;
            font-size: 1.2rem;
            padding: 0.5rem 1.5rem;
            border-radius: 6px;
            border: 1px solid var(--gold);
            min-width: 250px;
            box-shadow: inset 0 0 10px rgba(255, 215, 0, 0.5);
        }

        /* Mobile Adjustments (Ensures cards stay side-by-side) */
        @media (max-width: 500px) {
            .table {
                padding: 1rem;
            }
            .player-card {
                width: calc(50% - 0.5rem); /* Keeps them side-by-side */
            }
            .title {
                font-size: 2rem;
            }
        }
    </style>
</head>
<body>

<!-- Apply .table styling to the main container -->
<div class="table">
    <div class="title">Centralized Node Graph</div>
    
    <!-- Player Info (Now simplified and compact) -->
    <div class="player-info">
        <!-- Player 1 -->
        <div class="player-card active" data-player="P1" id="player1Card">
            <div class="player-header">
                <h2 id="player1Name">Player 1</h2>
            </div>
            <div class="piece-display yellow"></div>
        </div>
        <!-- Player 2 -->
        <div class="player-card" data-player="P2" id="player2Card">
            <div class="player-header">
                <h2 id="player2Name">Player 2</h2>
            </div>
            <div class="piece-display red"></div>
        </div>
    </div>
    
    <!-- Game Controls and Status -->
    <div class="game-controls">
        <button id="newGameButton" class="control-button">Start New Game</button>
        <div id="statusMessage" class="game-status">Game status updates here.</div>
    </div>

    <!-- Canvas element where the graph will be drawn -->
    <canvas id="graphCanvas" width="600" height="600"></canvas>
</div>

<script>
    // --- Global Game State ---
    let gameState = {
        currentPlayer: 'P1', // 'P1' (Yellow) or 'P2' (Red)
        status: 'Ready to start!',
        p1Name: 'Player 1', // Simplified name for status messages
        p2Name: 'Player 2'  // Simplified name for status messages
    };
    
    // Constants for drawing
    const CANVAS_WIDTH = 600;
    const CANVAS_HEIGHT = 600;
    const NODE_RADIUS = 28;
    const LINE_WIDTH = 4;
    
    // Casino Theme Colors for JS Drawing
    const LINE_COLOR = '#4a2c2a'; // Dark wood color for lines on ivory background
    const TEXT_COLOR = '#1a1a1a'; // Very dark text
    const NODE_BORDER_COLOR = '#4a2c2a'; // Dark wood border for nodes
    
    // Using Inter font for node labels (Roboto is the body font)
    const FONT_STYLE = `${NODE_RADIUS * 0.5}px Inter`; 

    /* Node coordinates maintained from the last step, creating separation with central node M. */
    const nodes = {
        // Left Cluster (Brown/Gray: #B5A599)
        A: { x: 75, y: 150, label: 'A', color: '#B5A599' }, 
        C: { x: 175, y: 150, label: 'C', color: '#B5A599' }, 
        D: { x: 75, y: 300, label: 'D', color: '#B5A599' },
        F: { x: 175, y: 300, label: 'F', color: '#B5A599' },
        G: { x: 75, y: 450, label: 'G', color: '#B5A599' },
        H: { x: 175, y: 450, label: 'H', color: '#B5A599' },

        // Central Node (Connector: #FFD700)
        M: { x: 300, y: 300, label: 'M', color: '#FFD700' }, // Gold color 

        // Right Cluster (Red: #E57373)
        K: { x: 425, y: 150, label: 'K', color: '#E57373' }, 
        L: { x: 525, y: 150, label: 'L', color: '#E57373' }, 
        N: { x: 425, y: 300, label: 'N', color: '#E57373' },
        O: { x: 525, y: 300, label: 'O', color: '#E57373' },
        P: { x: 425, y: 450, label: 'P', color: '#E57373' },
        R: { x: 525, y: 450, label: 'R', color: '#E57373' },
    };

    // Edge data: connections flow through the central 'M' node
    const edges = [
        // Left Internal (Horizontal)
        ['A', 'C'], ['D', 'F'], ['G', 'H'],
        // Left Internal (Vertical)
        ['A', 'D'], ['D', 'G'], ['C', 'F'], ['F', 'H'],

        // Right Internal (Horizontal)
        ['K', 'L'], ['N', 'O'], ['P', 'R'],
        // Right Internal (Vertical)
        ['K', 'N'], ['N', 'P'], ['L', 'O'], ['O', 'R'],

        // Connecting (Crossover) - All connections now pass through 'M'
        ['C', 'M'], ['M', 'P'], 
        ['H', 'M'], ['M', 'K'], 
        ['F', 'M'], ['M', 'N'], 
    ];


    function drawGraph() {
        const canvas = document.getElementById('graphCanvas');
        if (!canvas) return;

        // Reset canvas size 
        canvas.width = CANVAS_WIDTH;
        canvas.height = CANVAS_HEIGHT;

        const ctx = canvas.getContext('2d');
        // Clear the canvas 
        ctx.clearRect(0, 0, CANVAS_WIDTH, CANVAS_HEIGHT);

        // --- 1. Draw Edges (Lines) ---
        ctx.strokeStyle = LINE_COLOR;
        ctx.lineWidth = LINE_WIDTH;
        ctx.lineCap = 'round';

        ctx.beginPath();
        edges.forEach(([node1Key, node2Key]) => {
            const n1 = nodes[node1Key];
            const n2 = nodes[node2Key];
            if (n1 && n2) {
                ctx.moveTo(n1.x, n1.y);
                ctx.lineTo(n2.x, n2.y);
            }
        });
        ctx.stroke();

        // --- 2. Draw Nodes (Circles) and Labels ---
        ctx.textAlign = 'center';
        ctx.textBaseline = 'middle';
        ctx.font = FONT_STYLE;

        // Draw nodes in an order that ensures 'M' is drawn last to overlap lines
        const allNodes = Object.values(nodes);
        
        // Draw all nodes except M first
        allNodes.filter(node => node.label !== 'M').forEach(node => {
            drawNode(ctx, node);
        });

        // Draw node M last 
        const nodeM = nodes.M;
        if (nodeM) {
            drawNode(ctx, nodeM);
        }
    }

    /**
     * Helper function to draw a single node with casino-style shadow and border.
     */
    function drawNode(ctx, node) {
        // Draw Node Circle
        ctx.beginPath();
        ctx.arc(node.x, node.y, NODE_RADIUS, 0, Math.PI * 2);

        // Apply fill color
        ctx.fillStyle = node.color;
        
        // Add a casino-style shadow/depth to the nodes
        ctx.shadowColor = 'rgba(0, 0, 0, 0.6)';
        ctx.shadowBlur = 6;
        ctx.shadowOffsetX = 3;
        ctx.shadowOffsetY = 3;
        ctx.fill();

        // Draw the dark border for definition
        ctx.strokeStyle = NODE_BORDER_COLOR;
        ctx.lineWidth = 2;
        ctx.stroke();


        // Reset shadow for clear text
        ctx.shadowBlur = 0;
        ctx.shadowOffsetX = 0;
        ctx.shadowOffsetY = 0;

        // Draw Node Label
        ctx.fillStyle = TEXT_COLOR;
        ctx.fillText(node.label, node.x, node.y);
    }
    
    // --- Removed Player Name Editing Functions (Not needed for static Player 1/2 labels) ---

    /**
     * Stub function to reset the game state.
     */
    function resetGame() {
        // Reset game state variables
        gameState.currentPlayer = 'P1';
        gameState.status = `${gameState.p1Name}'s turn. Make your first move!`;
        
        // Update UI
        updateStatus();
        updateTurnIndicator();
        drawGraph(); // Redraw board if necessary
        
        console.log('Game reset! Current player:', gameState.p1Name);
    }

    /**
     * Updates the status message in the UI.
     */
    function updateStatus() {
        const statusMessageEl = document.getElementById('statusMessage');
        statusMessageEl.textContent = gameState.status;
    }
    
    /**
     * Updates the active styling on player cards based on the current player.
     */
    function updateTurnIndicator() {
        const p1Card = document.getElementById('player1Card');
        const p2Card = document.getElementById('player2Card');

        if (gameState.currentPlayer === 'P1') {
            p1Card.classList.add('active');
            p2Card.classList.remove('active');
        } else {
            p1Card.classList.remove('active');
            p2Card.classList.add('active');
        }
    }

    function setupControls() {
        const newGameButton = document.getElementById('newGameButton');
        newGameButton.addEventListener('click', resetGame);
    }

    function initializeApp() {
        // Initial setup
        setupControls();
        drawGraph();
        
        // Set initial game status
        resetGame(); // Calls updateStatus and updateTurnIndicator
    }
    
    // Run the drawing function and initialize when the window loads
    window.onload = initializeApp;

    // Redraw on window resize
    window.addEventListener('resize', drawGraph);
</script>
</body>
</html>

