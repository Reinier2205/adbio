<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Hex Board Game</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #0B3D91;
      color: #fff;
      text-align: center;
      margin: 0;
      padding: 20px;
    }

    h1 {
      margin-bottom: 20px;
    }

    #board {
      margin: 20px auto;
      display: block;
    }

    .players {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin: 20px 0;
    }

    .player {
      padding: 10px 20px;
      border: 2px solid #fff;
      border-radius: 8px;
      background: #222;
      min-width: 80px;
    }

    .active {
      border-color: gold;
      background: #444;
    }

    #history {
      margin-top: 20px;
      min-height: 50px;
      background: #111;
      border: 1px solid #666;
      padding: 10px;
      border-radius: 8px;
    }

    button {
      margin-top: 20px;
      padding: 10px 15px;
      font-size: 16px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
    }

    button:hover {
      background: gold;
      color: #000;
    }
  </style>
</head>
<body>
  <h1>Hex Board Game</h1>

  <div class="players">
    <div id="playerX" class="player active">Player X</div>
    <div id="playerO" class="player">Player O</div>
    <div id="playerT" class="player">Player ▲</div>
  </div>

  <svg id="board" width="600" height="600"></svg>

  <div id="history">Game history:</div>
  <button id="reset">Reset Game</button>

  <script>
    const board = document.getElementById("board");
    const historyDiv = document.getElementById("history");

    const hexRadius = 40;
    const n = 4; // hexagon size
    const players = ["X", "O", "T"];
    let currentPlayer = 0;
    const moves = {};

    function hexToPixel(q, r) {
      const x = hexRadius * Math.sqrt(3) * (q + r/2);
      const y = hexRadius * 3/2 * r;
      return {x, y};
    }

    function polygonCorners(x, y) {
      const points = [];
      for (let i = 0; i < 6; i++) {
        const angle = Math.PI / 3 * i + Math.PI/6;
        const px = x + hexRadius * Math.cos(angle);
        const py = y + hexRadius * Math.sin(angle);
        points.push(`${px},${py}`);
      }
      return points.join(" ");
    }

    function drawHex(q, r, s) {
      const center = hexToPixel(q, r);
      const polygon = document.createElementNS("http://www.w3.org/2000/svg", "polygon");
      polygon.setAttribute("points", polygonCorners(center.x + 300, center.y + 300));
      polygon.setAttribute("stroke", "#fff");
      polygon.setAttribute("fill", "transparent");
      polygon.dataset.q = q;
      polygon.dataset.r = r;
      polygon.dataset.s = s;

      polygon.addEventListener("click", () => makeMove(polygon));
      board.appendChild(polygon);
    }

    function makeMove(cell) {
      const key = `${cell.dataset.q},${cell.dataset.r},${cell.dataset.s}`;
      if (moves[key]) return;

      const center = hexToPixel(parseInt(cell.dataset.q), parseInt(cell.dataset.r));
      const mark = document.createElementNS("http://www.w3.org/2000/svg", "g");

      const player = players[currentPlayer];
      if (player === "X" || player === "O") {
        const text = document.createElementNS("http://www.w3.org/2000/svg", "text");
        text.setAttribute("x", center.x + 300);
        text.setAttribute("y", center.y + 305);
        text.setAttribute("text-anchor", "middle");
        text.setAttribute("font-size", "28");
        text.setAttribute("fill", player === "X" ? "red" : "cyan");
        text.textContent = player;
        mark.appendChild(text);
      } else if (player === "T") {
        const size = 20;
        const x = center.x + 300, y = center.y + 300;
        const triangle = document.createElementNS("http://www.w3.org/2000/svg", "polygon");
        triangle.setAttribute("points", `${x},${y - size} ${x - size},${y + size} ${x + size},${y + size}`);
        triangle.setAttribute("fill", "yellow");
        mark.appendChild(triangle);
      }

      board.appendChild(mark);
      moves[key] = player;

      historyDiv.innerHTML += `<div>Player ${player} → ${key}</div>`;

      // update player panel highlight
      document.querySelectorAll(".player").forEach(p => p.classList.remove("active"));
      currentPlayer = (currentPlayer + 1) % players.length;
      if (players[currentPlayer] === "X") document.getElementById("playerX").classList.add("active");
      if (players[currentPlayer] === "O") document.getElementById("playerO").classList.add("active");
      if (players[currentPlayer] === "T") document.getElementById("playerT").classList.add("active");
    }

    function drawBoard() {
      for (let q = -n; q <= n; q++) {
        for (let r = -n; r <= n; r++) {
          let s = -q - r;
          if (Math.abs(s) <= n) drawHex(q, r, s);
        }
      }
    }

    function resetGame() {
      board.innerHTML = "";
      historyDiv.innerHTML = "Game history:";
      Object.keys(moves).forEach(k => delete moves[k]);
      currentPlayer = 0;
      document.querySelectorAll(".player").forEach(p => p.classList.remove("active"));
      document.getElementById("playerX").classList.add("active");
      drawBoard();
    }

    document.getElementById("reset").addEventListener("click", resetGame);

    drawBoard();
  </script>
</body>
</html>