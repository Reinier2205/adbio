<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Hexagon Tic-Tac-Toe (3 Players)</title>
  <style>
    body {
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      margin: 0;
      background: #f0f0f0;
      font-family: Arial, sans-serif;
    }

    canvas {
      background: white;
      border: 2px solid #333;
      box-shadow: 0 0 10px rgba(0,0,0,0.3);
      cursor: pointer;
    }
  </style>
</head>
<body>
  <canvas id="gameCanvas" width="600" height="600"></canvas>
  <script>
    const canvas = document.getElementById("gameCanvas");
    const ctx = canvas.getContext("2d");

    const hexRadius = 50;
    const boardSize = 4; // n=4 hexagon-of-hexagons
    const hexHeight = Math.sqrt(3) * hexRadius;

    const players = ["X", "O", "â–³"];
    let currentPlayer = 0;

    // Storage for hexagons
    let hexes = [];

    function drawHexagon(x, y, radius, fill=false, text="") {
      ctx.beginPath();
      for (let i = 0; i < 6; i++) {
        const angle = Math.PI / 3 * i + Math.PI / 6;
        const px = x + radius * Math.cos(angle);
        const py = y + radius * Math.sin(angle);
        if (i === 0) ctx.moveTo(px, py);
        else ctx.lineTo(px, py);
      }
      ctx.closePath();
      ctx.strokeStyle = "#333";
      ctx.lineWidth = 2;
      ctx.stroke();
      if (fill) {
        ctx.fillStyle = "#ddd";
        ctx.fill();
      }
      if (text) {
        ctx.fillStyle = "#000";
        ctx.font = "24px Arial";
        ctx.textAlign = "center";
        ctx.textBaseline = "middle";
        ctx.fillText(text, x, y);
      }
    }

    function generateBoard(n) {
      hexes = [];
      for (let q = -n+1; q <= n-1; q++) {
        const r1 = Math.max(-n+1, -q-n+1);
        const r2 = Math.min(n-1, -q+n-1);
        for (let r = r1; r <= r2; r++) {
          const x = canvas.width/2 + hexRadius * 3/2 * q;
          const y = canvas.height/2 + hexHeight * (r + q/2);
          hexes.push({q, r, x, y, value: ""});
        }
      }
    }

    function drawBoard() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      for (let hex of hexes) {
        drawHexagon(hex.x, hex.y, hexRadius-2, false, hex.value);
      }
    }

    function hexClicked(mx, my) {
      for (let hex of hexes) {
        const dx = mx - hex.x;
        const dy = my - hex.y;
        if (Math.sqrt(dx*dx + dy*dy) < hexRadius*0.9) {
          return hex;
        }
      }
      return null;
    }

    canvas.addEventListener("click", (e) => {
      const rect = canvas.getBoundingClientRect();
      const mx = e.clientX - rect.left;
      const my = e.clientY - rect.top;
      const hex = hexClicked(mx, my);
      if (hex && hex.value === "") {
        hex.value = players[currentPlayer];
        currentPlayer = (currentPlayer + 1) % players.length;
        drawBoard();
      }
    });

    generateBoard(boardSize);
    drawBoard();
  </script>
</body>
</html>