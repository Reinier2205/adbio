<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>3-Player Hex Tic-Tac-Toe</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #222;
      color: #fff;
      display: flex;
      flex-direction: column;
      align-items: center;
      margin: 0;
      padding: 0;
    }

    h1 {
      margin: 20px;
    }

    #players {
      display: flex;
      gap: 20px;
      margin-bottom: 20px;
    }

    .player-panel {
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 10px 15px;
      background: #333;
      border-radius: 8px;
      border: 2px solid transparent;
      min-width: 80px;
    }

    .player-panel.active {
      border-color: gold;
    }

    .player-symbol {
      font-size: 32px;
      margin-bottom: 5px;
    }

    /* Triangle marker: proper equilateral yellow triangle */
    .triangle-symbol {
      width: 0;
      height: 0;
      border-left: 18px solid transparent;
      border-right: 18px solid transparent;
      border-bottom: 32px solid yellow;
    }

    svg {
      margin-top: 20px;
      background: #111;
      border: 2px solid #444;
      border-radius: 12px;
    }

    polygon.hex {
      fill: #222;
      stroke: #888;
      stroke-width: 2;
      cursor: pointer;
      transition: fill 0.2s;
    }

    polygon.hex:hover {
      fill: #444;
    }

    text {
      font-size: 20px;
      font-weight: bold;
      fill: white;
      pointer-events: none;
      dominant-baseline: middle;
      text-anchor: middle;
    }

    .x-symbol { fill: red; }
    .o-symbol { fill: cyan; }
    .triangle-board { fill: yellow; }
  </style>
</head>
<body>
  <h1>3-Player Hex Tic-Tac-Toe</h1>

  <div id="players">
    <div class="player-panel active" id="playerX">
      <div class="player-symbol">X</div>
      <div>Player X</div>
    </div>
    <div class="player-panel" id="playerO">
      <div class="player-symbol">O</div>
      <div>Player O</div>
    </div>
    <div class="player-panel" id="playerT">
      <div class="player-symbol"><div class="triangle-symbol"></div></div>
      <div>Player ▲</div>
    </div>
  </div>

  <svg id="board" width="600" height="600"></svg>

  <script>
    const svg = document.getElementById("board");
    const size = 4; // n=4 hexagon-of-hexagons
    const hexSize = 40;
    const players = ["X", "O", "▲"];
    let currentPlayer = 0;

    // track board state
    let cells = [];

    function drawHex(cx, cy, r) {
      let points = [];
      for (let i = 0; i < 6; i++) {
        const angle = Math.PI / 3 * i;
        const x = cx + r * Math.cos(angle);
        const y = cy + r * Math.sin(angle);
        points.push(`${x},${y}`);
      }
      return points.join(" ");
    }

    function axialToPixel(q, r) {
      const x = hexSize * (Math.sqrt(3) * q + Math.sqrt(3)/2 * r);
      const y = hexSize * (3/2 * r);
      return [x, y];
    }

    function generateBoard(n) {
      const coords = [];
      for (let q = -n+1; q <= n-1; q++) {
        for (let r = -n+1; r <= n-1; r++) {
          let s = -q-r;
          if (Math.max(Math.abs(q), Math.abs(r), Math.abs(s)) < n) {
            coords.push([q,r]);
          }
        }
      }
      return coords;
    }

    const boardCoords = generateBoard(size);
    const offsetX = 280;
    const offsetY = 280;

    boardCoords.forEach(([q,r], index) => {
      const [x,y] = axialToPixel(q,r);
      const hex = document.createElementNS("http://www.w3.org/2000/svg", "polygon");
      hex.setAttribute("points", drawHex(x+offsetX, y+offsetY, hexSize-2));
      hex.setAttribute("class", "hex");
      svg.appendChild(hex);

      const cell = { q, r, el: hex, symbol: null };
      cells.push(cell);

      hex.addEventListener("click", () => {
        if (cell.symbol) return; // already taken
        const symbol = players[currentPlayer];
        cell.symbol = symbol;

        if (symbol === "X" || symbol === "O") {
          const text = document.createElementNS("http://www.w3.org/2000/svg", "text");
          text.setAttribute("x", x+offsetX);
          text.setAttribute("y", y+offsetY+5);
          text.setAttribute("class", symbol === "X" ? "x-symbol" : "o-symbol");
          text.textContent = symbol;
          svg.appendChild(text);
        } else if (symbol === "▲") {
          const tri = document.createElementNS("http://www.w3.org/2000/svg", "polygon");
          const sizeT = 18;
          const points = [
            [x+offsetX, y+offsetY-20],
            [x+offsetX-16, y+offsetY+12],
            [x+offsetX+16, y+offsetY+12]
          ].map(p => p.join(",")).join(" ");
          tri.setAttribute("points", points);
          tri.setAttribute("class", "triangle-board");
          svg.appendChild(tri);
        }

        // switch player
        document.querySelectorAll(".player-panel").forEach(p => p.classList.remove("active"));
        currentPlayer = (currentPlayer + 1) % players.length;
        document.getElementById(
          currentPlayer === 0 ? "playerX" : currentPlayer === 1 ? "playerO" : "playerT"
        ).classList.add("active");
      });
    });
  </script>
</body>
</html>