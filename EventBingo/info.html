<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="robots" content="noindex, nofollow" />
  <meta name="form-detection" content="telephone=no" />
  <title>EventBingo - How to Play</title>
  <style>
    :root {
      --primary: #4a90e2;
      --secondary: #7b68ee;
      --accent: #ff6b6b;
      --success: #51cf66;
      --text-dark: #2c3e50;
      --text-light: #ffffff;
      --bg-light: rgba(255, 255, 255, 0.95);
      --bg-dark: rgba(44, 62, 80, 0.9);
      --instagram-pink: #E4405F;
      --instagram-purple: #833AB4;
      --instagram-orange: #F77737;
      --instagram-yellow: #FCAF45;
      --story-gradient: linear-gradient(45deg, var(--instagram-pink), var(--instagram-purple), var(--instagram-orange), var(--instagram-yellow));
    }

    body {
      font-family: 'Segoe UI', sans-serif;
      background: #fafafa;
      color: var(--text-dark);
      margin: 0;
      padding: 0;
      min-height: 100vh;
      line-height: 1.6;
    }

    /* Instagram-style Top Bar */
    .top-bar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 12px 20px;
      background: var(--bg-light);
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      position: sticky;
      top: 0;
      z-index: 1000;
      backdrop-filter: blur(10px);
    }

    .back-button {
      font-size: 1.5rem;
      cursor: pointer;
      padding: 8px;
      border-radius: 50%;
      transition: background-color 0.2s ease;
      text-decoration: none;
      color: var(--text-dark);
    }

    .back-button:hover {
      background-color: rgba(0,0,0,0.1);
    }

    .page-title {
      font-size: 1.2rem;
      font-weight: bold;
      color: var(--text-dark);
    }

    .share-icon {
      font-size: 1.5rem;
      cursor: pointer;
      padding: 8px;
      border-radius: 50%;
      transition: background-color 0.2s ease;
    }

    .share-icon:hover {
      background-color: rgba(0,0,0,0.1);
    }

    /* Main Content */
    .main-content {
      max-width: 600px;
      margin: 0 auto;
      padding: 20px;
      padding-bottom: 80px;
    }

    .hero-section {
      text-align: center;
      margin-bottom: 40px;
      padding: 30px 20px;
      background: var(--story-gradient);
      border-radius: 20px;
      color: white;
      box-shadow: 0 4px 20px rgba(0,0,0,0.1);
    }

    .hero-title {
      font-size: 2.5rem;
      font-weight: bold;
      margin-bottom: 10px;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
    }

    .hero-subtitle {
      font-size: 1.2rem;
      opacity: 0.9;
      margin-bottom: 20px;
    }

    .hero-description {
      font-size: 1rem;
      opacity: 0.8;
      max-width: 400px;
      margin: 0 auto;
    }

    .section {
      background: white;
      border-radius: 15px;
      padding: 25px;
      margin-bottom: 20px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }

    .section-title {
      font-size: 1.4rem;
      font-weight: bold;
      color: var(--instagram-pink);
      margin-bottom: 15px;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .section-content {
      font-size: 1rem;
      line-height: 1.7;
    }

    .step {
      display: flex;
      align-items: flex-start;
      gap: 15px;
      margin-bottom: 20px;
      padding: 15px;
      background: #f8f9fa;
      border-radius: 12px;
      border-left: 4px solid var(--instagram-pink);
    }

    .step-number {
      background: var(--story-gradient);
      color: white;
      width: 30px;
      height: 30px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      flex-shrink: 0;
    }

    .step-content {
      flex: 1;
    }

    .step-title {
      font-weight: bold;
      margin-bottom: 5px;
      color: var(--text-dark);
    }

    .step-description {
      color: #666;
      font-size: 0.95rem;
    }

    .feature-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 15px;
      margin-top: 20px;
    }

    .feature-card {
      background: #f8f9fa;
      padding: 20px;
      border-radius: 12px;
      text-align: center;
      border: 2px solid transparent;
      transition: all 0.3s ease;
    }

    .feature-card:hover {
      border-color: var(--instagram-pink);
      transform: translateY(-2px);
    }

    .feature-icon {
      font-size: 2rem;
      margin-bottom: 10px;
    }

    .feature-title {
      font-weight: bold;
      margin-bottom: 8px;
      color: var(--text-dark);
    }

    .feature-description {
      font-size: 0.9rem;
      color: #666;
    }

    .highlight-box {
      background: linear-gradient(135deg, rgba(228, 64, 95, 0.1), rgba(131, 58, 180, 0.1));
      border: 2px solid var(--instagram-pink);
      border-radius: 15px;
      padding: 20px;
      margin: 20px 0;
      text-align: center;
    }

    .highlight-title {
      font-size: 1.3rem;
      font-weight: bold;
      color: var(--instagram-pink);
      margin-bottom: 10px;
    }

    .highlight-text {
      color: var(--text-dark);
      font-size: 1rem;
    }

    .example-card {
      background: white;
      border-radius: 12px;
      padding: 20px;
      margin: 15px 0;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      border-left: 4px solid var(--instagram-orange);
    }

    .example-title {
      font-weight: bold;
      color: var(--instagram-orange);
      margin-bottom: 10px;
    }

    .example-text {
      color: #666;
      font-style: italic;
    }

    /* Bottom Navigation */
    .bottom-nav {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      background: var(--bg-light);
      display: flex;
      justify-content: space-around;
      padding: 16px 0;
      box-shadow: 0 -2px 10px rgba(0,0,0,0.1);
      backdrop-filter: blur(10px);
      z-index: 1000;
    }

    .nav-icon {
      font-size: 1.8rem;
      cursor: pointer;
      padding: 10px 14px;
      border-radius: 12px;
      transition: all 0.2s ease;
      text-decoration: none;
      color: var(--text-dark);
      display: flex;
      align-items: center;
      justify-content: center;
      min-width: 48px;
      min-height: 48px;
    }

    .nav-icon:hover {
      background-color: rgba(0,0,0,0.1);
      transform: translateY(-2px);
    }

    .nav-icon.active {
      background: var(--story-gradient);
      color: white;
      box-shadow: 0 4px 12px rgba(228, 64, 95, 0.3);
    }

    /* Dark mode for info page */
    body.dark-mode {
      background: #1a1a1a;
      color: #ffffff;
    }
    
    body.dark-mode .top-bar,
    body.dark-mode .bottom-nav {
      background: #2d2d2d;
      border-color: #404040;
    }
    
    body.dark-mode .page-title,
    body.dark-mode .back-button,
    body.dark-mode .nav-icon {
      color: #ffffff;
    }
    
    body.dark-mode .section {
      background: #2d2d2d;
      border-color: #404040;
    }
    
    body.dark-mode .hero-section {
      box-shadow: 0 4px 20px rgba(0,0,0,0.4);
    }
    
    body.dark-mode .step {
      background: #333333;
      border-left-color: var(--instagram-pink);
    }
    
    body.dark-mode .step-title {
      color: #ffffff;
    }
    
    body.dark-mode .step-description {
      color: #cccccc;
    }
    
    body.dark-mode .feature-card {
      background: #333333;
    }
    
    body.dark-mode .feature-title {
      color: #ffffff;
    }
    
    body.dark-mode .feature-description {
      color: #cccccc;
    }
    
    body.dark-mode .example-card {
      background: #2d2d2d;
      border-left-color: var(--instagram-orange);
    }
    
    body.dark-mode .example-title {
      color: var(--instagram-orange);
    }
    
    body.dark-mode .example-text {
      color: #cccccc;
    }
    
    body.dark-mode .highlight-text {
      color: #ffffff;
    }
    
    body.dark-mode #eventCodeInput {
      background: #333333;
      color: #ffffff;
      border-color: #555555;
    }
    
    body.dark-mode #eventCodeInput::placeholder {
      color: #999999;
    }
    
    body.dark-mode #noCodeBtn {
      background: #333333;
      color: #ffffff;
      border-color: #555555;
    }
    
    body.dark-mode #eventHint {
      color: #999999;
    }

    /* Loading Animation */
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    /* Responsive */
    @media (max-width: 768px) {
      .hero-title {
        font-size: 2rem;
      }
      
      .main-content {
        padding: 15px;
      }
      
      .section {
        padding: 20px;
      }
      
      .feature-grid {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <!-- Instagram-style Top Bar -->
  <div class="top-bar">
    <a href="index.html" class="back-button">‚Üê</a>
    <div class="page-title">How to Play EventBingo</div>
    <div class="share-icon" onclick="shareInfo()">üì§</div>
  </div>

  <!-- Main Content -->
  <div class="main-content">
    <!-- Hero Section -->
    <div class="hero-section">
      <div class="hero-title">üéâ EventBingo</div>
  
      <div class="hero-description">
        Turn your celebration into an interactive photo adventure! 
        Complete challenges, capture memories, and compete with friends.
      </div>
    </div>

    <!-- Quick Continue Section -->
    <div id="quickContinueSection" style="display: none; text-align: center; margin-bottom: 30px;">
      <button id="quickContinueBtn" style="
        background: var(--story-gradient);
        color: white;
        border: none;
        padding: 15px 30px;
        border-radius: 15px;
        font-size: 1.1rem;
        font-weight: bold;
        cursor: pointer;
        box-shadow: 0 4px 15px rgba(228, 64, 95, 0.3);
        transition: all 0.2s ease;
      ">
        ‚Ü©Ô∏è Continue with Last Event
      </button>
    </div>

    <!-- What is EventBingo -->
    <div class="section">
      <div class="section-title">
        <span>üéØ</span>
        What is EventBingo?
      </div>
      <div class="section-content">
        <p>EventBingo is a fun, interactive way to capture memories during special occasions. Instead of a traditional bingo game with numbers, you complete photo challenges that celebrate the person and the event.</p>
        
        <div class="highlight-box">
          <div class="highlight-title">üéä The Goal</div>
          <div class="highlight-text">
            Complete as many photo challenges as possible during the event. 
            The more squares you complete, the more memories you'll capture!
          </div>
        </div>

        <p>Each square represents a specific photo challenge related to Anneke's 35th birthday celebration. From capturing spontaneous moments to finding specific items or activities, each challenge is designed to create lasting memories.</p>
      </div>
    </div>

    <div class="section">
      <div class="section-title">
        <span>üöÄ</span>
        Ready to Start?
      </div>
      <div class="section-content">
        <div class="highlight-box">
          <div class="highlight-title">Let's Capture Some Memories!</div>
          <div class="highlight-text">
            Click the back button to return to the main EventBingo game and start completing challenges. 
            Remember to have fun and capture the special moments of your event and celebration!
          </div>
        </div>
        
        <div style="text-align: center; margin-top: 20px;">
          <div style="margin: 0 auto; max-width: 420px; text-align: left;">
            <label for="eventCodeInput" style="display:block; font-weight: 600; margin-bottom: 8px; color: var(--text-dark);">Enter your event code</label>
            <input id="eventCodeInput" type="text" placeholder="e.g. Susan35" autocomplete="off" data-form-type="other" style="width: 100%; padding: 12px 14px; border-radius: 12px; border: 2px solid #e0e0e0; font-size: 1rem; outline: none;" />
            <div style="display:flex; gap: 10px; margin-top: 12px; flex-wrap: wrap;">
              <button id="startPlayingBtn" style="flex:1; background: var(--story-gradient); color: white; padding: 12px 16px; border-radius: 12px; border: none; font-weight: bold; cursor: pointer;">üéâ Let's start playing</button>
              <button id="noCodeBtn" style="background: #f1f5f9; color: #111827; padding: 12px 16px; border-radius: 12px; border: 1px solid #e5e7eb; font-weight: 600; cursor: pointer;">I don't have a code</button>
              <button id="continueLastBtn" style="display:none; background: #10b981; color: white; padding: 12px 16px; border-radius: 12px; border: none; font-weight: 700; cursor: pointer;">‚Ü©Ô∏è Continue with last event</button>
            </div>
            <div id="eventHelp" style="display:none; margin-top: 10px; color: #dc2626; font-weight: 600;">We couldn't find that event. Double-check the code or ask your host.</div>
            <div id="eventHint" style="margin-top: 10px; color: #6b7280; font-size: 0.9rem;">Tip: We'll remember your last event on this device.</div>
          </div>
        </div>
      </div>
    </div>

    <!-- How to Play -->
    <div class="section">
      <div class="section-title">
        <span>üì±</span>
        How to Play
      </div>
      <div class="section-content">
        <div class="step">
          <div class="step-number">1</div>
          <div class="step-content">
            <div class="step-title">Choose Your Player</div>
            <div class="step-description">Click on a player circle at the top, or create a new player by clicking in the empty space.</div>
          </div>
        </div>

        <div class="step">
          <div class="step-number">2</div>
          <div class="step-content">
            <div class="step-title">Read the Challenge</div>
            <div class="step-description">Each card shows a specific photo challenge. Read it carefully to understand what you need to capture.</div>
          </div>
        </div>

        <div class="step">
          <div class="step-number">3</div>
          <div class="step-content">
            <div class="step-title">Take Your Photo</div>
            <div class="step-description">Click the "+" button to upload a photo that matches the challenge. Make sure it's a good shot!</div>
          </div>
        </div>

        <div class="step">
          <div class="step-number">4</div>
          <div class="step-content">
            <div class="step-title">Complete & Celebrate</div>
            <div class="step-description">Once uploaded, the card shows ‚úÖ and you can react with emojis. Complete all 25 squares for a confetti celebration!</div>
          </div>
        </div>
      </div>
    </div>

    <!-- Features -->
    <div class="section">
      <div class="section-title">
        <span>‚ú®</span>
        App Features
      </div>
      <div class="section-content">
        <div class="feature-grid">
          <div class="feature-card">
            <div class="feature-icon">üë•</div>
            <div class="feature-title">Multiple Players</div>
            <div class="feature-description">Switch between different players to see everyone's progress</div>
          </div>
          
          <div class="feature-card">
            <div class="feature-icon">üì∏</div>
            <div class="feature-title">Photo Gallery</div>
            <div class="feature-description">View all uploaded photos in a beautiful carousel</div>
          </div>
          
          <div class="feature-card">
            <div class="feature-icon">üèÜ</div>
            <div class="feature-title">Leaderboard</div>
            <div class="feature-description">See who's completed the most challenges</div>
          </div>
          
          <div class="feature-card">
            <div class="feature-icon">üîç</div>
            <div class="feature-title">Filter View</div>
            <div class="feature-description">Show only completed squares to focus on achievements</div>
          </div>
          
          <div class="feature-card">
            <div class="feature-icon">üåì</div>
            <div class="feature-title">Dark Mode</div>
            <div class="feature-description">Switch between light and dark themes</div>
          </div>
          
          <div class="feature-card">
            <div class="feature-icon">üîó</div>
            <div class="feature-title">Share Progress</div>
            <div class="feature-description">Share your EventBingo link with friends</div>
          </div>
        </div>
      </div>
    </div>

    <!-- Challenge Examples -->
    <div class="section">
      <div class="section-title">
        <span>üìã</span>
        Challenge Examples
      </div>
      <div class="section-content">
        <p>Here are some examples of the photo challenges you'll find:</p>
        
        <div class="example-card">
          <div class="example-title">"A old phto with Anneke"</div>
          <div class="example-text">Find an old photo of you with Anneke and take a picture of it</div>
        </div>
        
        <div class="example-card">
          <div class="example-title">"Everyone together around the campfire"</div>
          <div class="example-text">Get everyone together around the campfire for a group photo</div>
        </div>
        
        <div class="example-card">
          <div class="example-title">"John's laugh captured in a spontaneous photo"</div>
          <div class="example-text">Capture a genuine laugh in a candid moment</div>
        </div>
      </div>
    </div>

    <!-- Tips -->
    <div class="section">
      <div class="section-title">
        <span>üí°</span>
        Pro Tips
      </div>
      <div class="section-content">
        <div class="step">
          <div class="step-number">üì±</div>
          <div class="step-content">
            <div class="step-title">Use Your Phone</div>
            <div class="step-description">The app works best on mobile devices. Keep your phone handy throughout the event!</div>
          </div>
        </div>

        <div class="step">
          <div class="step-number">‚ö°</div>
          <div class="step-content">
            <div class="step-title">Be Quick</div>
            <div class="step-description">Some moments are fleeting - don't hesitate to capture spontaneous moments!</div>
          </div>
        </div>

        <div class="step">
          <div class="step-number">üé®</div>
          <div class="step-content">
            <div class="step-title">Get Creative</div>
            <div class="step-description">Think outside the box for creative interpretations of the challenges</div>
          </div>
        </div>

        <div class="step">
          <div class="step-number">üë•</div>
          <div class="step-content">
            <div class="step-title">Work Together</div>
            <div class="step-description">Help each other complete challenges - it's more fun as a team!</div>
          </div>
        </div>
      </div>
    </div>


  </div>

  <!-- Bottom Navigation -->
  <div class="bottom-nav" id="bottomNav" style="display: none;">
    <a href="index.html" class="nav-icon">üè†</a>
    <a href="info.html?stay=true" class="nav-icon active">‚ÑπÔ∏è</a>
    <div class="nav-icon" onclick="openCarousel()">üì∏</div>
    <div class="nav-icon" onclick="toggleDarkMode()">üåì</div>
    <div class="nav-icon" onclick="toggleMusic()">üéµ</div>
  </div>

  <!-- Include Session Management System -->
  <script src="js/error-handler.js"></script>
  <script src="js/performance-monitor.js"></script>
  <script src="js/performance-dashboard.js"></script>
  <script src="js/legacy-cleanup.js"></script>
  <script src="js/session-manager.js" onload="console.log('SessionManager script loaded')" onerror="console.error('Failed to load SessionManager script')"></script>
  <script src="js/player-authenticator.js" onload="console.log('PlayerAuthenticator script loaded')" onerror="console.error('Failed to load PlayerAuthenticator script')"></script>
  <script src="js/state-preserver.js" onload="console.log('StatePreserver script loaded')" onerror="console.error('Failed to load StatePreserver script')"></script>
  <script src="js/flow-controller.js" onload="console.log('FlowController script loaded')" onerror="console.error('Failed to load FlowController script')"></script>
  <script src="js/secret-question-auth.js"></script>
  <script src="js/player-switching-interface.js"></script>
  <script src="js/view-only-mode.js"></script>
  
  <script>
    const workerURL = "https://shy-recipe-5fb1.reinier-olivier.workers.dev/";
    
    // Comprehensive extension error suppression
    (function() {
      // Store original console methods
      const originalConsoleError = console.error;
      const originalConsoleWarn = console.warn;
      
      // Override console.error to filter extension errors
      console.error = function(...args) {
        const message = args.join(' ');
        if (message.includes('content_script') ||
            message.includes('Cannot read properties of undefined') ||
            message.includes('shouldOfferCompletionListForField') ||
            message.includes('elementWasFocused') ||
            message.includes('MetadataHeuristicsRunner') ||
            message.includes('findAndFocusActiveElementIfPossible') ||
            message.includes('reading \'control\'') ||
            message.includes('focusInEventHandler') ||
            message.includes('TypeError: Cannot read properties of undefined') ||
            message.includes('.control') ||
            message.includes('field.control') ||
            message.includes('.some(') && message.includes('undefined')) {
          // Silently ignore extension errors
          return;
        }
        originalConsoleError.apply(console, args);
      };
      
      // Override window.onerror to catch all errors
      const originalOnError = window.onerror;
      window.onerror = function(message, source, lineno, colno, error) {
        // Check if this is an extension error
        if (source && (
          source.includes('extension://') || 
          source.includes('content_script') ||
          source.includes('chrome-extension://') ||
          source.includes('moz-extension://')
        )) {
          // Silently ignore extension errors
          return true; // Prevents default error handling
        }
        
        // Check message patterns
        if (message && (
          message.includes('content_script') ||
          message.includes('Cannot read properties of undefined') ||
          message.includes('shouldOfferCompletionListForField') ||
          message.includes('elementWasFocused') ||
          message.includes('MetadataHeuristicsRunner') ||
          message.includes('focusInEventHandler') ||
          message.includes('TypeError: Cannot read properties of undefined') ||
          message.includes('.control') ||
          message.includes('field.control') ||
          message.includes('findAndFocusActiveElementIfPossible') ||
          message.includes('reading \'control\'')
        )) {
          // Silently ignore these errors
          return true;
        }
        
        // Call original handler for legitimate errors
        if (originalOnError) {
          return originalOnError.call(this, message, source, lineno, colno, error);
        }
        
        // Log legitimate errors using original console.error
        originalConsoleError.call(console, 'EventBingo Info Error:', {
          message: message,
          source: source,
          line: lineno,
          column: colno,
          error: error
        });
        
        return false;
      };
      
      // Override addEventListener to filter error events
      const originalAddEventListener = EventTarget.prototype.addEventListener;
      EventTarget.prototype.addEventListener = function(type, listener, options) {
        if (type === 'error' && listener) {
          const wrappedListener = function(event) {
            // Filter extension errors
            if (event.filename && (
              event.filename.includes('extension://') || 
              event.filename.includes('content_script') ||
              event.filename.includes('chrome-extension://') ||
              event.filename.includes('moz-extension://')
            )) {
              return; // Don't call the listener
            }
            
            if (event.message && (
              event.message.includes('content_script') ||
              event.message.includes('Cannot read properties of undefined') ||
              event.message.includes('shouldOfferCompletionListForField') ||
              event.message.includes('elementWasFocused') ||
              event.message.includes('MetadataHeuristicsRunner') ||
              event.message.includes('focusInEventHandler') ||
              event.message.includes('TypeError: Cannot read properties of undefined') ||
              event.message.includes('.control') ||
              event.message.includes('field.control') ||
              event.message.includes('reading \'control\'')
            )) {
              return; // Don't call the listener
            }
            
            // Call original listener for legitimate errors
            return listener.call(this, event);
          };
          
          return originalAddEventListener.call(this, type, wrappedListener, options);
        }
        
        return originalAddEventListener.call(this, type, listener, options);
      };
    })();
    
    // Global error handler for debugging (after suppression)
    window.addEventListener('error', function(event) {
      console.error('EventBingo Info: Unfiltered error:', {
        message: event.message,
        filename: event.filename,
        lineno: event.lineno,
        colno: event.colno,
        error: event.error
      });
    });
    
    // Unhandled promise rejection handler
    window.addEventListener('unhandledrejection', function(event) {
      // Filter out extension-related promise rejections
      if (event.reason && typeof event.reason === 'object' && event.reason.message) {
        if (event.reason.message.includes('content_script') || 
            event.reason.message.includes('Cannot read properties of undefined') ||
            event.reason.message.includes('focusInEventHandler') ||
            event.reason.message.includes('shouldOfferCompletionListForField') ||
            event.reason.message.includes('.control') ||
            event.reason.message.includes('field.control')) {
          console.log('Info page: Ignoring extension-related promise rejection');
          event.preventDefault();
          return;
        }
      }
      
      console.error('Info page: Unhandled promise rejection:', {
        reason: event.reason,
        promise: event.promise
      });
    });
    

    // Instagram-style functions
    function shareInfo() {
      console.log('shareInfo() called');
      try {
        const url = window.location.href;
        if (navigator.share) {
          navigator.share({
            title: 'EventBingo - How to Play',
            text: 'Learn how to play EventBingo and capture amazing memories!',
            url: url
          });
        } else {
          navigator.clipboard.writeText(url).then(() => {
            alert('Link copied to clipboard!');
          });
        }
      } catch (error) {
        console.error('shareInfo error:', error);
      }
    }

    function openCarousel() {
      console.log('openCarousel() called');
      try {
        const urlParams = new URLSearchParams(window.location.search);
        let eventCode = urlParams.get('event');
        const player = urlParams.get('player') || '';
        
        console.log('openCarousel: eventCode =', eventCode, 'player =', player);
        
        // If no event code in URL, try to get from session manager
        if (!eventCode && sessionManager) {
          console.log('openCarousel: Trying to get last used event from sessionManager');
          sessionManager.getLastUsedEvent().then(lastEvent => {
            console.log('openCarousel: Got last event:', lastEvent);
            if (lastEvent) {
              eventCode = lastEvent;
              navigateToCarousel(eventCode, player);
            } else {
              console.warn('No event code available for carousel navigation');
            }
          }).catch(error => {
            console.error('Failed to get last used event for carousel:', error);
          });
          return;
        }
        
        console.log('openCarousel: Navigating to carousel with eventCode:', eventCode || 'default');
        navigateToCarousel(eventCode || 'default', player);
      } catch (error) {
        console.error('Failed to open carousel:', error);
      }
    }

    function navigateToCarousel(eventCode, player) {
      try {
        // Preserve navigation context before navigating
        if (statePreserver) {
          statePreserver.saveNavigationState({
            fromPage: 'info.html',
            toPage: 'carousel.html',
            eventCode: eventCode,
            playerName: player,
            action: 'openCarousel'
          });
          
          statePreserver.trackUserAction('navigation', {
            action: 'openCarousel',
            fromPage: 'info.html',
            toPage: 'carousel.html',
            eventCode: eventCode,
            playerName: player
          });
        }
        
        const carouselUrl = player 
          ? `carousel.html?event=${encodeURIComponent(eventCode)}&player=${encodeURIComponent(player)}`
          : `carousel.html?event=${encodeURIComponent(eventCode)}`;
        window.location.href = carouselUrl;
      } catch (error) {
        console.error('Failed to navigate to carousel:', error);
      }
    }

    function toggleDarkMode() {
      console.log('toggleDarkMode() called');
      try {
        document.body.classList.toggle('dark-mode');
        // Save preference using consistent key
        const isDarkMode = document.body.classList.contains('dark-mode');
        console.log('toggleDarkMode: isDarkMode =', isDarkMode);
        localStorage.setItem('eventbingo:darkMode', isDarkMode.toString());
        
        // Track the action for consistency
        if (statePreserver) {
          statePreserver.trackUserAction('toggleDarkMode', {
            darkMode: isDarkMode,
            page: 'info.html'
          });
        }
      } catch (error) {
        console.error('toggleDarkMode error:', error);
      }
    }

    // Detect and apply dark mode from app's localStorage setting
    function detectDarkMode() {
      try {
        const isDarkMode = localStorage.getItem('eventbingo:darkMode') === 'true';
        if (isDarkMode) {
          document.body.classList.add('dark-mode');
        }
      } catch (error) {
        console.log('Could not detect dark mode preference');
      }
    }

    function toggleMusic() {
      console.log('toggleMusic() called');
      console.log('Music toggle - feature coming soon!');
    }

    // Add smooth scrolling for better UX
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
      anchor.addEventListener('click', function (e) {
        e.preventDefault();
        document.querySelector(this.getAttribute('href')).scrollIntoView({
          behavior: 'smooth'
        });
      });
    });

    // Detect dark mode immediately
    detectDarkMode();

    // Global variables for session management
    let sessionManager, playerAuthenticator, statePreserver, flowController, errorHandler, performanceMonitor, performanceDashboard;

    // Initialize FlowController for seamless navigation
    document.addEventListener('DOMContentLoaded', async function() {
      // Add a small delay to ensure all scripts are loaded
      await new Promise(resolve => setTimeout(resolve, 100));
      
      try {
        console.log('Info page: Initializing session management system...');
        
        // Check for required classes with graceful fallbacks
        console.log('Info page: Checking class availability...');
        console.log('ErrorHandler available:', typeof ErrorHandler !== 'undefined');
        console.log('SessionManager available:', typeof SessionManager !== 'undefined');
        console.log('PlayerAuthenticator available:', typeof PlayerAuthenticator !== 'undefined');
        console.log('FlowController available:', typeof FlowController !== 'undefined');
        console.log('StatePreserver available:', typeof StatePreserver !== 'undefined');
        
        if (typeof SessionManager === 'undefined') {
          throw new Error('SessionManager class not loaded - critical dependency missing');
        }
        
        // For other classes, warn but don't fail completely
        if (typeof ErrorHandler === 'undefined') {
          console.warn('ErrorHandler class not loaded, using fallback');
        }
        if (typeof PlayerAuthenticator === 'undefined') {
          console.warn('PlayerAuthenticator class not loaded, some features may not work');
        }
        if (typeof FlowController === 'undefined') {
          console.warn('FlowController class not loaded, using fallback navigation');
        }
        if (typeof StatePreserver === 'undefined') {
          console.warn('StatePreserver class not loaded, state preservation disabled');
        }
        
        // Initialize components with error handling
        errorHandler = typeof ErrorHandler !== 'undefined' ? new ErrorHandler() : null;
        performanceMonitor = typeof PerformanceMonitor !== 'undefined' ? new PerformanceMonitor() : null;
        performanceDashboard = performanceMonitor && typeof PerformanceDashboard !== 'undefined' ? new PerformanceDashboard(performanceMonitor) : null;
        
        sessionManager = new SessionManager(errorHandler, performanceMonitor);
        playerAuthenticator = typeof PlayerAuthenticator !== 'undefined' ? new PlayerAuthenticator(sessionManager, errorHandler) : null;
        statePreserver = typeof StatePreserver !== 'undefined' ? new StatePreserver(sessionManager) : null;
        flowController = typeof FlowController !== 'undefined' ? new FlowController(sessionManager, playerAuthenticator, statePreserver, errorHandler) : null;
        
        console.log('Info page: Session management system initialized successfully');
        
        // Test basic functionality
        console.log('Info page: Testing basic functionality...');
        console.log('SessionManager available:', typeof sessionManager, sessionManager ? 'initialized' : 'not initialized');
        console.log('PlayerAuthenticator available:', typeof playerAuthenticator, playerAuthenticator ? 'initialized' : 'not initialized');
        console.log('FlowController available:', typeof flowController, flowController ? 'initialized' : 'not initialized');
        console.log('ErrorHandler available:', typeof errorHandler, errorHandler ? 'initialized' : 'not initialized');
        
        // Test SessionManager methods
        if (sessionManager && typeof sessionManager.isStorageAvailable === 'function') {
          console.log('SessionManager storage available:', sessionManager.isStorageAvailable());
        }
        
        // Test performance monitoring
        if (performanceMonitor && typeof performanceMonitor.recordSessionOperation === 'function') {
          performanceMonitor.recordSessionOperation('info-page-initialization', 0, 'test');
          console.log('Info page: Performance monitoring test completed');
        }
        
        // Test button functionality
        console.log('Info page: Testing button functionality...');
        
        // Test if functions are available in global scope
        console.log('shareInfo function available:', typeof shareInfo);
        console.log('openCarousel function available:', typeof openCarousel);
        console.log('toggleDarkMode function available:', typeof toggleDarkMode);
        console.log('toggleMusic function available:', typeof toggleMusic);
        
        // Test if DOM elements exist
        const shareButton = document.querySelector('[onclick="shareInfo()"]');
        const carouselButton = document.querySelector('[onclick="openCarousel()"]');
        const darkModeButton = document.querySelector('[onclick="toggleDarkMode()"]');
        const musicButton = document.querySelector('[onclick="toggleMusic()"]');
        
        console.log('Share button found:', !!shareButton);
        console.log('Carousel button found:', !!carouselButton);
        console.log('Dark mode button found:', !!darkModeButton);
        console.log('Music button found:', !!musicButton);
        
        // Add click event listeners as backup
        if (shareButton) {
          shareButton.addEventListener('click', function(e) {
            console.log('Share button clicked via event listener');
            e.preventDefault();
            shareInfo();
          });
        }
        
        if (carouselButton) {
          carouselButton.addEventListener('click', function(e) {
            console.log('Carousel button clicked via event listener');
            e.preventDefault();
            openCarousel();
          });
        }
        
        if (darkModeButton) {
          darkModeButton.addEventListener('click', function(e) {
            console.log('Dark mode button clicked via event listener');
            e.preventDefault();
            toggleDarkMode();
          });
        }
        
        if (musicButton) {
          musicButton.addEventListener('click', function(e) {
            console.log('Music button clicked via event listener');
            e.preventDefault();
            toggleMusic();
          });
        }
        
        // Make components globally available
        window.sessionManager = sessionManager;
        window.playerAuthenticator = playerAuthenticator;
        window.errorHandler = errorHandler;
        window.flowController = flowController;
        
        if (performanceMonitor) {
          window.performanceMonitor = performanceMonitor;
          console.log('Info page: Performance monitoring enabled');
        }
        
        if (performanceDashboard) {
          window.performanceDashboard = performanceDashboard;
          console.log('Info page: Performance dashboard enabled');
        }
        
        // Initialize legacy cleanup if available
        if (typeof LegacyCleanup !== 'undefined') {
          const legacyCleanup = new LegacyCleanup();
          window.legacyCleanup = legacyCleanup;
          
          // Perform cleanup of any remaining legacy code
          const cleanupResult = legacyCleanup.performCompleteCleanup({
            sessionManager,
            playerAuthenticator,
            flowController
          });
          
          if (cleanupResult.summary.totalItemsRemoved > 0) {
            console.log(`Info page: Legacy cleanup completed: ${cleanupResult.summary.totalItemsRemoved} items removed`);
          }
        }
        
        // Restore navigation context from previous page
        let restoredContext = null;
        if (flowController && typeof flowController.restoreNavigationContext === 'function') {
          restoredContext = flowController.restoreNavigationContext();
          if (restoredContext) {
            console.log('Info: Restored navigation context:', restoredContext);
            
            // Track that we restored context
            if (statePreserver && typeof statePreserver.trackUserAction === 'function') {
              statePreserver.trackUserAction('contextRestored', {
                fromPage: restoredContext.fromPage,
                toPage: restoredContext.toPage || 'info.html',
                eventCode: restoredContext.eventCode,
                action: restoredContext.action
              });
            }
          }
        } else {
          console.log('Info: FlowController not available, skipping context restoration');
        }
        
        // Check if user explicitly navigated to info page
        const urlParams = new URLSearchParams(window.location.search);
        const stayOnInfo = urlParams.has('stay') || urlParams.has('info');
        const explicitInfoVisit = !urlParams.has('event') && !document.referrer.includes('index.html');
        const shouldStayOnInfo = stayOnInfo || explicitInfoVisit;
        
        console.log('Info page: Should stay on info:', shouldStayOnInfo);
        
        // Show a message if we're staying on info page due to saved session
        if (shouldStayOnInfo && sessionManager) {
          const lastUsedEvent = await sessionManager.getLastUsedEvent();
          if (lastUsedEvent) {
            console.log('Info page: Staying on info page despite having saved session for:', lastUsedEvent);
          }
        }
        console.log('Info page: Stay parameter:', stayOnInfo);
        console.log('Info page: Explicit visit detected:', explicitInfoVisit);
        console.log('Info page: URL params:', Object.fromEntries(urlParams.entries()));
        console.log('Info page: Referrer:', document.referrer);
        
        // Handle page load with seamless flow, but respect explicit info page visits
        let flowResult;
        
        if (shouldStayOnInfo || !flowController) {
          console.log('Info page: User wants to stay on info page or FlowController not available');
          console.log('Info page: Reasons - stayParam:', stayOnInfo, 'explicitVisit:', explicitInfoVisit, 'flowController:', !!flowController);
          // Don't use flow controller when user explicitly wants to stay on info page or it's not available
          flowResult = { 
            success: true, 
            action: 'showInfoPage', 
            reason: shouldStayOnInfo ? 'explicit_info_visit' : 'flowcontroller_unavailable'
          };
        } else {
          console.log('Info page: Using flow controller for navigation');
          try {
            flowResult = await flowController.handlePageLoad();
          } catch (error) {
            console.error('Info page: FlowController.handlePageLoad failed:', error);
            flowResult = { 
              success: true, 
              action: 'showInfoPage', 
              reason: 'flowcontroller_error'
            };
          }
        }
        
        console.log('Info page flow controller result:', flowResult);
        
        if (flowResult.success) {
          // Save current state for context preservation
          if (statePreserver && typeof statePreserver.saveNavigationState === 'function') {
            statePreserver.saveNavigationState({
              eventCode: flowResult.eventCode,
              page: 'info.html',
              action: flowResult.action,
              initialized: true
            });
          }
          
          if (flowResult.action === 'navigatingToEventSelection') {
            // FlowController is handling navigation, let it proceed
            return;
          }
          
          if (flowResult.action === 'navigating' || flowResult.action === 'navigatingToGameInterface') {
            // FlowController is navigating away, let it proceed
            console.log('Info page: FlowController is handling navigation, allowing redirect');
            return;
          }
          
          // If we have an event code from the flow controller, update the UI
          if (flowResult.eventCode) {
            updateUIForEvent(flowResult.eventCode);
          }
        }
        
        // Check for saved sessions and show quick continue option
        await checkForSavedSessions();
        
        // Continue with normal info page functionality
        // The existing landing flow will handle event code input
      } catch (error) {
        console.error('Failed to initialize info page with flow controller:', error);
        console.error('Error details:', {
          message: error.message,
          stack: error.stack,
          name: error.name
        });
        
        // Check what components are available for debugging
        console.log('Available components on info page:', {
          ErrorHandler: typeof ErrorHandler,
          SessionManager: typeof SessionManager,
          PlayerAuthenticator: typeof PlayerAuthenticator,
          FlowController: typeof FlowController,
          PerformanceMonitor: typeof PerformanceMonitor,
          windowSessionManager: typeof window.sessionManager,
          windowErrorHandler: typeof window.errorHandler
        });
        
        // Try to initialize basic components for fallback
        try {
          if (typeof SessionManager !== 'undefined' && !window.sessionManager) {
            console.log('Info page: Attempting fallback SessionManager initialization...');
            window.sessionManager = new SessionManager();
            sessionManager = window.sessionManager;
          }
        } catch (fallbackError) {
          console.error('Info page: Fallback initialization also failed:', fallbackError);
        }
        
        // Continue with normal info page functionality
      }
    });

    // Check for saved sessions and show quick continue option
    async function checkForSavedSessions() {
      try {
        if (!sessionManager) return;
        
        const lastUsedEvent = await sessionManager.getLastUsedEvent();
        const allSessions = await sessionManager.getAllPlayerSessions();
        
        if (lastUsedEvent && allSessions.length > 0) {
          const lastSession = allSessions.find(s => s.eventCode === lastUsedEvent);
          
          if (lastSession) {
            showQuickContinueOption(lastUsedEvent, lastSession.playerName);
          }
        }
      } catch (error) {
        console.error('Failed to check for saved sessions:', error);
      }
    }

    // Show quick continue option for returning users
    function showQuickContinueOption(eventCode, playerName) {
      const quickContinueSection = document.getElementById('quickContinueSection');
      const quickContinueBtn = document.getElementById('quickContinueBtn');
      
      if (quickContinueSection && quickContinueBtn) {
        quickContinueBtn.textContent = `‚Ü©Ô∏è Continue as ${playerName} in ${eventCode}`;
        quickContinueBtn.onclick = async () => {
          try {
            // Preserve navigation context
            if (statePreserver) {
              statePreserver.saveNavigationState({
                fromPage: 'info.html',
                toPage: 'index.html',
                eventCode: eventCode,
                playerName: playerName,
                action: 'quickContinue'
              });
              
              statePreserver.trackUserAction('navigation', {
                action: 'quickContinue',
                fromPage: 'info.html',
                toPage: 'index.html',
                eventCode: eventCode,
                playerName: playerName
              });
            }
            
            // Show bottom navigation since we're continuing with a valid event
            document.getElementById('bottomNav').style.display = 'flex';
            
            // Navigate to game interface
            window.location.href = `index.html?event=${encodeURIComponent(eventCode)}&player=${encodeURIComponent(playerName)}`;
          } catch (error) {
            console.error('Failed to continue with saved session:', error);
          }
        };
        
        quickContinueSection.style.display = 'block';
      }
    }

    // Update UI when we have a valid event code
    function updateUIForEvent(eventCode) {
      try {
        // Show bottom navigation
        const bottomNav = document.getElementById('bottomNav');
        if (bottomNav) {
          bottomNav.style.display = 'flex';
        }
        
        // Update event code input if it exists
        const eventInput = document.getElementById('eventCodeInput');
        if (eventInput && !eventInput.value) {
          eventInput.value = eventCode;
        }
        
        // Update page title to include event
        const pageTitle = document.querySelector('.page-title');
        if (pageTitle && eventCode) {
          pageTitle.textContent = `EventBingo - ${eventCode}`;
        }
      } catch (error) {
        console.error('Failed to update UI for event:', error);
      }
    }

    // Landing flow: event code capture, validation, and redirection
    (async function initLandingFlow() {
      const input = document.getElementById('eventCodeInput');
      const startBtn = document.getElementById('startPlayingBtn');
      const noCodeBtn = document.getElementById('noCodeBtn');
      const help = document.getElementById('eventHelp');

      if (!input || !startBtn) return;

      // Check if there's an event in URL parameters and show bottom nav
      const urlParams = new URLSearchParams(window.location.search);
      if (urlParams.has('event')) {
        document.getElementById('bottomNav').style.display = 'flex';
      }

      // Prefill from last used event using SessionManager
      let lastEvent = '';
      try {
        if (sessionManager) {
          lastEvent = await sessionManager.getLastUsedEvent() || '';
        } else {
          // Fallback to direct localStorage access
          lastEvent = localStorage.getItem('eventbingo:lastEvent') || '';
        }
        if (lastEvent) input.value = lastEvent;
      } catch (_) {}
      
      // Show quick-continue if we have a remembered event
      const continueBtn = document.getElementById('continueLastBtn');
      if (continueBtn && lastEvent) {
        continueBtn.style.display = 'inline-block';
        continueBtn.onclick = async () => {
          try {
            // Preserve navigation context before navigating
            if (statePreserver) {
              statePreserver.saveNavigationState({
                fromPage: 'info.html',
                toPage: 'index.html',
                eventCode: lastEvent,
                action: 'continueLastEvent'
              });
              
              statePreserver.trackUserAction('navigation', {
                action: 'continueLastEvent',
                fromPage: 'info.html',
                toPage: 'index.html',
                eventCode: lastEvent
              });
            }
            
            // Show bottom navigation since we're continuing with a valid event
            document.getElementById('bottomNav').style.display = 'flex';
            window.location.href = `index.html?event=${encodeURIComponent(lastEvent)}`;
          } catch (error) {
            console.error('Failed to continue with last event:', error);
          }
        };
      }

      async function validateAndStart() {
        console.log('validateAndStart() called');
        const code = (input.value || '').trim();
        console.log('validateAndStart: code =', code);
        help.style.display = 'none';
        if (!code) {
          help.textContent = 'Please enter your event code to continue.';
          help.style.display = 'block';
          input.focus();
          return;
        }
        
        // Show loading state
        startBtn.disabled = true;
        startBtn.innerHTML = '<div style="display: flex; align-items: center; gap: 8px;"><div style="width: 16px; height: 16px; border: 2px solid rgba(255,255,255,0.3); border-top: 2px solid white; border-radius: 50%; animation: spin 1s linear infinite;"></div>Validating...</div>';
        
        // Validate with worker
        try {
          const res = await fetch(`${workerURL}event-info?event=${encodeURIComponent(code)}`);
          if (res.ok) {
            // Save last used event using SessionManager
            try {
              if (sessionManager) {
                await sessionManager.setLastUsedEvent(code);
              } else {
                // Fallback to direct localStorage
                localStorage.setItem('eventbingo:lastEvent', code);
              }
            } catch (error) {
              console.error('Failed to save last used event:', error);
            }
            
            startBtn.innerHTML = '‚úÖ Event found! Redirecting...';
            // Show bottom navigation since event is valid
            document.getElementById('bottomNav').style.display = 'flex';
            
            setTimeout(() => {
              // Preserve navigation context before navigating
              if (statePreserver) {
                statePreserver.saveNavigationState({
                  fromPage: 'info.html',
                  toPage: 'index.html',
                  eventCode: code,
                  action: 'validateAndStart'
                });
                
                statePreserver.trackUserAction('navigation', {
                  action: 'validateAndStart',
                  fromPage: 'info.html',
                  toPage: 'index.html',
                  eventCode: code
                });
              }
              
              window.location.href = `index.html?event=${encodeURIComponent(code)}`;
            }, 500);
            return;
          }
          // Not found ‚Üí offer next steps
          help.textContent = "We couldn't find that event. Start a new event or ask your host for the correct code.";
          help.style.display = 'block';
          showNoCodeOptions(code);
        } catch (e) {
          help.textContent = 'We could not validate the event right now. Please check your connection and try again.';
          help.style.display = 'block';
        } finally {
          // Reset button
          startBtn.disabled = false;
          startBtn.innerHTML = 'üéâ Let\'s start playing';
        }
      }

      function showNoCodeOptions(prefill) {
        // Offer to start a new event (admin page) or copy a friendly message to ask host
        const ask = `Hi! Please share the EventBingo code so I can join. Thanks!`;
        const actions = document.createElement('div');
        actions.style.cssText = 'margin-top:10px; display:flex; gap:10px; flex-wrap:wrap;';
        actions.innerHTML = `
          <a href="admin.html" style="background:#111827; color:white; padding:10px 14px; border-radius:10px; text-decoration:none; font-weight:600;">Start a new event</a>
          <button id="copyAskMsg" style="background:#f8fafc; color:#111827; padding:10px 14px; border:1px solid #e5e7eb; border-radius:10px; font-weight:600; cursor:pointer;">Ask event host</button>
        `;
        const container = document.getElementById('eventHint').parentElement;
        const existing = document.getElementById('copyAskMsg');
        if (!existing) container.appendChild(actions);
        setTimeout(() => {
          const btn = document.getElementById('copyAskMsg');
          if (btn) btn.onclick = async () => {
            try { await navigator.clipboard.writeText(ask); btn.textContent = '‚úÖ Copied! Share it with your host via WhatsApp, text, or any app you like'; } catch (_) {}
          };
        }, 0);
      }

      startBtn.addEventListener('click', validateAndStart);
      input.addEventListener('keydown', (e) => { if (e.key === 'Enter') validateAndStart(); });
      noCodeBtn?.addEventListener('click', () => showNoCodeOptions());
    })();

    // Handle navigation errors and provide recovery options
    function handleNavigationError(error, context = {}) {
      try {
        console.error('Navigation error occurred:', error, context);
        
        if (statePreserver) {
          // Track the error for debugging
          statePreserver.trackUserAction('navigationError', {
            error: error.message,
            context: context,
            page: 'info.html',
            timestamp: Date.now()
          });
          
          // Provide fallback options
          const fallbackOptions = statePreserver.provideFallbackOptions('navigationError');
          
          if (fallbackOptions.success && fallbackOptions.options.length > 0) {
            showRecoveryOptions(fallbackOptions.options);
          }
        }
      } catch (recoveryError) {
        console.error('Failed to handle navigation error:', recoveryError);
      }
    }

    // Show recovery options to the user
    function showRecoveryOptions(options) {
      try {
        const container = document.querySelector('.main-content');
        if (!container) return;
        
        // Create recovery section
        const recoverySection = document.createElement('div');
        recoverySection.className = 'section';
        recoverySection.innerHTML = `
          <div class="section-title">
            <span>üîß</span>
            Recovery Options
          </div>
          <div class="section-content">
            <p>We encountered an issue. Here are some options to continue:</p>
            <div id="recoveryOptions"></div>
          </div>
        `;
        
        const optionsContainer = recoverySection.querySelector('#recoveryOptions');
        
        options.forEach(option => {
          const optionBtn = document.createElement('button');
          optionBtn.className = 'setup-btn setup-btn-secondary';
          optionBtn.style.cssText = 'margin: 5px; padding: 10px 15px; width: auto;';
          optionBtn.textContent = option.description;
          
          optionBtn.onclick = () => handleRecoveryOption(option);
          optionsContainer.appendChild(optionBtn);
        });
        
        // Insert at the top of main content
        container.insertBefore(recoverySection, container.firstChild);
      } catch (error) {
        console.error('Failed to show recovery options:', error);
      }
    }

    // Handle recovery option selection
    async function handleRecoveryOption(option) {
      try {
        switch (option.type) {
          case 'continueLastEvent':
          case 'continueLastSession':
            if (statePreserver) {
              statePreserver.saveNavigationState({
                fromPage: 'info.html',
                toPage: 'index.html',
                eventCode: option.eventCode,
                playerName: option.playerName,
                action: 'recoveryNavigation'
              });
            }
            window.location.href = `index.html?event=${encodeURIComponent(option.eventCode)}&player=${encodeURIComponent(option.playerName)}`;
            break;
            
          case 'selectSession':
            // Show session selection modal
            showSessionSelectionModal(option.sessions);
            break;
            
          case 'enterEventCode':
            // Focus on event code input
            const eventInput = document.getElementById('eventCodeInput');
            if (eventInput) {
              eventInput.focus();
              eventInput.scrollIntoView({ behavior: 'smooth' });
            }
            break;
            
          case 'goToInfo':
            // Already on info page, just scroll to top
            window.scrollTo({ top: 0, behavior: 'smooth' });
            break;
            
          default:
            console.warn('Unknown recovery option type:', option.type);
        }
        
        // Track recovery action
        if (statePreserver) {
          statePreserver.trackUserAction('recoveryAction', {
            optionType: option.type,
            page: 'info.html'
          });
        }
      } catch (error) {
        console.error('Failed to handle recovery option:', error);
      }
    }

    // Show session selection modal for recovery
    function showSessionSelectionModal(sessions) {
      // This would create a modal to select from available sessions
      // For now, just navigate to the most recent session
      if (sessions && sessions.length > 0) {
        const mostRecent = sessions[0];
        handleRecoveryOption({
          type: 'continueLastSession',
          eventCode: mostRecent.eventCode,
          playerName: mostRecent.playerName
        });
      }
    }
  </script>
</body>
</html>
