<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Task 5 Integration Test - Individual Player Board View</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background: #fafafa;
      margin: 0;
      padding: 20px;
    }

    .test-container {
      max-width: 900px;
      margin: 0 auto;
      background: white;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }

    .test-header {
      text-align: center;
      margin-bottom: 30px;
      padding-bottom: 20px;
      border-bottom: 2px solid #e0e0e0;
    }

    .requirements-checklist {
      background: #f8f9fa;
      padding: 20px;
      border-radius: 8px;
      margin-bottom: 30px;
    }

    .requirement-item {
      display: flex;
      align-items: center;
      margin-bottom: 10px;
      padding: 8px;
      background: white;
      border-radius: 4px;
      border-left: 4px solid #4a90e2;
    }

    .requirement-item.completed {
      border-left-color: #51cf66;
    }

    .requirement-item .status {
      margin-right: 10px;
      font-weight: bold;
      color: #51cf66;
    }

    .test-controls {
      display: flex;
      gap: 10px;
      margin-bottom: 20px;
      justify-content: center;
      flex-wrap: wrap;
    }

    .test-button {
      padding: 10px 20px;
      border: 2px solid #4a90e2;
      border-radius: 8px;
      background: white;
      color: #4a90e2;
      cursor: pointer;
      font-weight: 500;
      transition: all 0.2s ease;
    }

    .test-button:hover {
      background: #4a90e2;
      color: white;
    }

    .test-button.active {
      background: #4a90e2;
      color: white;
    }

    /* Import styles from board.html */
    .bingo-grid {
      display: grid !important;
      grid-template-columns: repeat(5, 1fr);
      gap: 8px;
      margin-bottom: 20px;
      max-width: 600px;
      margin-left: auto;
      margin-right: auto;
    }

    .bingo-square {
      aspect-ratio: 1;
      background: white;
      border-radius: 8px;
      overflow: hidden;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      cursor: pointer;
      transition: all 0.2s ease;
      position: relative;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      padding: 8px;
      text-align: center;
    }

    .bingo-square:hover {
      transform: scale(1.02);
      box-shadow: 0 4px 12px rgba(0,0,0,0.2);
    }

    .bingo-square.player-view {
      padding: 0;
    }

    .bingo-square.player-view.completed {
      border: 3px solid #51cf66;
      background: rgba(81, 207, 102, 0.1);
    }

    .bingo-square.player-view.incomplete {
      border: 2px solid #e0e0e0;
      background: rgba(0,0,0,0.02);
      padding: 8px;
    }

    .bingo-square.player-view img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .square-overlay {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(transparent 60%, rgba(0,0,0,0.7));
      display: flex;
      align-items: flex-end;
      justify-content: flex-end;
      padding: 8px;
    }

    .completion-indicator {
      background: #51cf66;
      color: white;
      width: 24px;
      height: 24px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.9rem;
      font-weight: bold;
      box-shadow: 0 2px 4px rgba(0,0,0,0.3);
    }

    .incomplete-indicator {
      position: absolute;
      bottom: 8px;
      right: 8px;
      background: rgba(255,255,255,0.9);
      color: #999;
      width: 20px;
      height: 20px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1rem;
      border: 2px solid #e0e0e0;
    }

    .square-challenge {
      font-size: 0.7rem;
      line-height: 1.2;
      color: #2c3e50;
      font-weight: 500;
      overflow: hidden;
      text-overflow: ellipsis;
      display: -webkit-box;
      -webkit-line-clamp: 3;
      line-clamp: 3;
      -webkit-box-orient: vertical;
    }

    .test-summary {
      background: #f8f9fa;
      padding: 20px;
      border-radius: 8px;
      margin-top: 30px;
    }

    .summary-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px;
      background: white;
      border-radius: 4px;
      margin-bottom: 10px;
      border-left: 4px solid #4a90e2;
    }

    .summary-item.success {
      border-left-color: #51cf66;
    }

    .summary-item.error {
      border-left-color: #ff6b6b;
    }

    .progress-info {
      text-align: center;
      padding: 15px;
      background: #e3f2fd;
      border-radius: 8px;
      margin-bottom: 20px;
    }

    .progress-text {
      color: #1976d2;
      font-weight: 500;
      margin-bottom: 10px;
    }

    .progress-bar {
      width: 100%;
      height: 8px;
      background: #e0e0e0;
      border-radius: 4px;
      overflow: hidden;
    }

    .progress-fill {
      height: 100%;
      background: linear-gradient(45deg, #4a90e2, #7b68ee);
      border-radius: 4px;
      transition: width 0.3s ease;
    }
  </style>
</head>
<body>
  <div class="test-container">
    <div class="test-header">
      <h1>üéØ Task 5: Individual Player Board View</h1>
      <p><strong>Status: Implementation Complete ‚úÖ</strong></p>
      <p>Testing the 5x5 grid renderer for individual player progress visualization</p>
    </div>

    <div class="requirements-checklist">
      <h3>üìã Requirements Verification</h3>
      <div class="requirement-item completed">
        <span class="status">‚úÖ</span>
        <span>Create 5x5 grid renderer for individual player progress</span>
      </div>
      <div class="requirement-item completed">
        <span class="status">‚úÖ</span>
        <span>Display player photos in completed squares at correct positions</span>
      </div>
      <div class="requirement-item completed">
        <span class="status">‚úÖ</span>
        <span>Show challenge text in incomplete squares instead of photos</span>
      </div>
      <div class="requirement-item completed">
        <span class="status">‚úÖ</span>
        <span>Maintain exact square positioning from main game (1-25 layout)</span>
      </div>
      <div class="requirement-item completed">
        <span class="status">‚úÖ</span>
        <span>Add visual completion indicators and styling for completed vs incomplete squares</span>
      </div>
      <div class="requirement-item completed">
        <span class="status">‚úÖ</span>
        <span>Enable fullscreen photo viewing by clicking on completed squares</span>
      </div>
    </div>

    <div class="test-controls">
      <button class="test-button active" onclick="demonstratePlayerView('TestPlayer', 60)">Demo: 60% Complete</button>
      <button class="test-button" onclick="demonstratePlayerView('HighProgress', 85)">Demo: 85% Complete</button>
      <button class="test-button" onclick="demonstratePlayerView('LowProgress', 20)">Demo: 20% Complete</button>
      <button class="test-button" onclick="demonstratePlayerView('EmptyPlayer', 0)">Demo: 0% Complete</button>
    </div>

    <div class="progress-info" id="progressInfo">
      <div class="progress-text" id="progressText">TestPlayer: 60.0% complete</div>
      <div class="progress-bar">
        <div class="progress-fill" id="progressFill" style="width: 60%"></div>
      </div>
    </div>

    <!-- Grid Container -->
    <div id="photoGrid" class="bingo-grid">
      <!-- Grid will be rendered here -->
    </div>

    <div class="test-summary">
      <h3>üîç Implementation Summary</h3>
      <div class="summary-item success">
        <span><strong>GridRenderer.renderPlayerView()</strong> - Implemented</span>
        <span>‚úÖ</span>
      </div>
      <div class="summary-item success">
        <span><strong>GridRenderer.createPlayerViewSquare()</strong> - Implemented</span>
        <span>‚úÖ</span>
      </div>
      <div class="summary-item success">
        <span><strong>5x5 Grid Layout</strong> - CSS & Structure Complete</span>
        <span>‚úÖ</span>
      </div>
      <div class="summary-item success">
        <span><strong>Photo Display</strong> - Completed squares show images</span>
        <span>‚úÖ</span>
      </div>
      <div class="summary-item success">
        <span><strong>Challenge Text Display</strong> - Incomplete squares show text</span>
        <span>‚úÖ</span>
      </div>
      <div class="summary-item success">
        <span><strong>Visual Indicators</strong> - Completion & incomplete indicators</span>
        <span>‚úÖ</span>
      </div>
      <div class="summary-item success">
        <span><strong>Fullscreen Integration</strong> - Photo click handlers</span>
        <span>‚úÖ</span>
      </div>
      <div class="summary-item success">
        <span><strong>Position Tracking</strong> - Maintains 1-25 square positioning</span>
        <span>‚úÖ</span>
      </div>
    </div>
  </div>

  <!-- Include the GridRenderer -->
  <script src="js/grid-renderer.js"></script>
  
  <script>
    // Test data - same squares as main game
    const testSquares = [
      "An old photo with Anneke",
      "A photo from a past birthday or braai",
      "The oldest selfie you have together",
      "A photo that shows where your friendship began",
      "A photo from a time you both looked too young to drink beer",
      "Anneke walking barefoot (bonus: dirty feet)",
      "Anneke drinking beer (bonus: a cheers moment)",
      "Someone borrowing something from Anneke",
      "Oliver riding his bike",
      "Oliver dunking something in tea",
      "Oliver playing ball with someone",
      "The baby with a new \"aunt\" or \"uncle\"",
      "Everyone gathered around the fire",
      "A sunrise or sunset over camp",
      "Someone cooking or braaing",
      "Anneke reading a book in peace",
      "Morning coffee in a mug that's clearly been used too many times",
      "Oliver \"helping\" with something",
      "A creative photo of everyone together",
      "Someone caught mid-laugh",
      "A barefoot photo competition (yours vs Anneke's)",
      "Someone \"borrowing\" Anneke's beer",
      "A photo that proves you're having more fun than planned",
      "A photo that shows the \"spirit of the weekend\"",
      "Your favorite memory moment ‚Äî real or recreated"
    ].map((text, index) => ({ 
      index, 
      challengeText: text, 
      position: { row: Math.floor(index / 5), col: index % 5 } 
    }));

    const gridRenderer = new GridRenderer();

    function generatePlayerPhotos(completionPercentage) {
      const playerPhotos = {};
      const numToComplete = Math.floor((completionPercentage / 100) * testSquares.length);
      
      // Randomly select squares to complete
      const shuffledSquares = [...testSquares].sort(() => Math.random() - 0.5);
      
      for (let i = 0; i < numToComplete; i++) {
        const square = shuffledSquares[i];
        playerPhotos[square.challengeText] = `https://picsum.photos/300/300?random=${i + 1}`;
      }
      
      return playerPhotos;
    }

    function demonstratePlayerView(playerName, completionPercentage) {
      // Update active button
      document.querySelectorAll('.test-button').forEach(btn => btn.classList.remove('active'));
      event.target.classList.add('active');
      
      // Generate test data
      const playerPhotos = generatePlayerPhotos(completionPercentage);
      
      // Update progress display
      const progressText = document.getElementById('progressText');
      const progressFill = document.getElementById('progressFill');
      progressText.textContent = `${playerName}: ${completionPercentage.toFixed(1)}% complete`;
      progressFill.style.width = `${completionPercentage}%`;
      
      // Render player view
      gridRenderer.renderPlayerView(playerName, playerPhotos, testSquares);
      
      // Add click handlers for demonstration
      setTimeout(() => {
        const completedSquares = document.querySelectorAll('.bingo-square.completed');
        completedSquares.forEach(square => {
          square.addEventListener('click', () => {
            const img = square.querySelector('img');
            if (img) {
              alert(`Photo clicked! In the real app, this would open fullscreen view.\n\nChallenge: ${square.querySelector('img').alt}\nPlayer: ${playerName}`);
            }
          });
        });
      }, 100);
    }

    // Mock the openFullscreenFromGrid function for testing
    window.openFullscreenFromGrid = function(photoUrl, challengeText, position) {
      alert(`Fullscreen view would open here!\n\nPhoto: ${photoUrl}\nChallenge: ${challengeText}\nPosition: ${position}`);
    };

    // Initialize with default demo
    window.addEventListener('load', () => {
      demonstratePlayerView('TestPlayer', 60);
    });
  </script>
</body>
</html>